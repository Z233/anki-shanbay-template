<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Back</title>
  <script src="https://unpkg.com/vue@next"></script>
</head>
<body class="h-screen w-screen">
  <div class="flex flex-col h-full relative items-center" id="back">
    <div class="p-4 space-y-2 w-full">
      <div class="flex justify-between items-center">
        <div class="space-y-1">
          <div class="text-5xl">{{单词}}</div>
          <div class="text-gray-400">{{音标}}</div>
        </div>
        <div class="cursor-pointer w-8"><svg class="pronounceIcon" viewBox="0 0 18 16" xmlns="http://www.w3.org/2000/svg"> <path d="M10.3 0.919917C10.8493 3.21298 11.1312 5.56197 11.14 7.91992C11.1539 10.1758 10.8784 12.4242 10.32 14.6099C10.2808 14.7694 10.2093 14.9192 10.11 15.0499C10.0146 15.1734 9.89565 15.2768 9.76004 15.3541C9.62444 15.4313 9.47488 15.4809 9.31998 15.4999H9.16996C8.91031 15.4999 8.6577 15.4157 8.44999 15.2599L4.75998 12.4499C4.71039 12.4409 4.65955 12.4409 4.60996 12.4499H1.96994C1.76621 12.4423 1.56774 12.3832 1.39292 12.2783C1.21809 12.1735 1.07258 12.0261 0.969944 11.8499C0.319087 10.666 -0.00532894 9.33043 0.0299416 7.97991C0.01615 6.54229 0.33802 5.12129 0.969944 3.82992C1.06823 3.62758 1.22185 3.45723 1.413 3.33865C1.60415 3.22006 1.82502 3.15809 2.04996 3.15991H4.66996C4.71894 3.15061 4.76618 3.13376 4.80997 3.10992L8.42997 0.279933C8.57072 0.182777 8.726 0.108523 8.88999 0.0599317C9.2013 -0.00998806 9.52756 0.0437908 9.79996 0.209926C10.053 0.372152 10.2325 0.627 10.3 0.919917V0.919917Z" fill="#20B6F2" /> <path class="volume-1 play" d="M14.3602 3.94009C14.2972 3.94468 14.2358 3.96251 14.1801 3.9924C14.1244 4.02229 14.0756 4.06358 14.0369 4.11359C13.9983 4.16359 13.9705 4.22116 13.9556 4.28259C13.9406 4.34402 13.9389 4.40791 13.9503 4.47009C14.09 5.62483 14.1601 6.78694 14.1602 7.9501C14.1616 9.09004 14.0915 10.2289 13.9503 11.3601C13.9419 11.4219 13.9458 11.4848 13.9619 11.545C13.9781 11.6053 14.006 11.6617 14.0442 11.711C14.0824 11.7603 14.13 11.8016 14.1842 11.8323C14.2385 11.8631 14.2983 11.8827 14.3602 11.8901H14.4303C14.5494 11.8908 14.6644 11.8471 14.7531 11.7676C14.8418 11.6882 14.8978 11.5786 14.9102 11.4601C15.0511 10.2887 15.1213 9.10993 15.1203 7.93011C15.1207 6.73369 15.0505 5.53827 14.9102 4.3501C14.8881 4.22451 14.8189 4.11213 14.7166 4.03592C14.6144 3.9597 14.4869 3.92541 14.3602 3.94009V3.94009Z" fill="#20B6F2" /> <path class="volume-2 play" d="M17.1602 2.54991C17.1507 2.48806 17.1287 2.42881 17.0955 2.37577C17.0622 2.32274 17.0185 2.27704 16.967 2.24146C16.9156 2.20589 16.8574 2.1812 16.796 2.16889C16.7347 2.15659 16.6714 2.15693 16.6102 2.1699C16.549 2.18073 16.4906 2.20361 16.4382 2.23719C16.3859 2.27078 16.3408 2.31439 16.3054 2.36555C16.2701 2.4167 16.2452 2.47437 16.2323 2.5352C16.2194 2.59602 16.2187 2.65879 16.2302 2.71989C16.5436 4.439 16.7042 6.18248 16.7102 7.92991C16.7089 9.62788 16.5482 11.322 16.2302 12.9899C16.2172 13.0511 16.2169 13.1143 16.2292 13.1757C16.2415 13.2371 16.2662 13.2953 16.3018 13.3468C16.3373 13.3982 16.3831 13.4419 16.4361 13.4751C16.4891 13.5083 16.5484 13.5304 16.6102 13.5399H16.7102C16.8206 13.537 16.9271 13.4985 17.0136 13.4299C17.1002 13.3614 17.1621 13.2666 17.1902 13.1599C17.5176 11.436 17.6783 9.6846 17.6702 7.92991C17.6432 6.12589 17.4727 4.32687 17.1602 2.54991V2.54991Z" fill="#20B6F2" /> </svg></div>
      </div>
      <div class="leading-8">
        {{释义}}
      </div>
      <div class="w-full h-0.5 bg-gray-200"></div>
      <span class="bg-gray-200 py-1 px-3 rounded-full text-sm text-gray-400 inline-block">例句</span>
      <div class="flex">
        <div class="leading-6 flex-grow">
          {{例句英文}}<br>
          <p class="text-gray-400 mt-1">{{例句中文}}</p>
        </div>
        <div class="relative bottom-1 w-8 h-8"><svg viewBox="0 0 18 16" xmlns="http://www.w3.org/2000/svg" class="sentenceIcon"> <path d="M10.3 0.919917C10.8493 3.21298 11.1312 5.56197 11.14 7.91992C11.1539 10.1758 10.8784 12.4242 10.32 14.6099C10.2808 14.7694 10.2093 14.9192 10.11 15.0499C10.0146 15.1734 9.89565 15.2768 9.76004 15.3541C9.62444 15.4313 9.47488 15.4809 9.31998 15.4999H9.16996C8.91031 15.4999 8.6577 15.4157 8.44999 15.2599L4.75998 12.4499C4.71039 12.4409 4.65955 12.4409 4.60996 12.4499H1.96994C1.76621 12.4423 1.56774 12.3832 1.39292 12.2783C1.21809 12.1735 1.07258 12.0261 0.969944 11.8499C0.319087 10.666 -0.00532894 9.33043 0.0299416 7.97991C0.01615 6.54229 0.33802 5.12129 0.969944 3.82992C1.06823 3.62758 1.22185 3.45723 1.413 3.33865C1.60415 3.22006 1.82502 3.15809 2.04996 3.15991H4.66996C4.71894 3.15061 4.76618 3.13376 4.80997 3.10992L8.42997 0.279933C8.57072 0.182777 8.726 0.108523 8.88999 0.0599317C9.2013 -0.00998806 9.52756 0.0437908 9.79996 0.209926C10.053 0.372152 10.2325 0.627 10.3 0.919917V0.919917Z" fill="#20B6F2" /> <path class="volume-1" d="M14.3602 3.94009C14.2972 3.94468 14.2358 3.96251 14.1801 3.9924C14.1244 4.02229 14.0756 4.06358 14.0369 4.11359C13.9983 4.16359 13.9705 4.22116 13.9556 4.28259C13.9406 4.34402 13.9389 4.40791 13.9503 4.47009C14.09 5.62483 14.1601 6.78694 14.1602 7.9501C14.1616 9.09004 14.0915 10.2289 13.9503 11.3601C13.9419 11.4219 13.9458 11.4848 13.9619 11.545C13.9781 11.6053 14.006 11.6617 14.0442 11.711C14.0824 11.7603 14.13 11.8016 14.1842 11.8323C14.2385 11.8631 14.2983 11.8827 14.3602 11.8901H14.4303C14.5494 11.8908 14.6644 11.8471 14.7531 11.7676C14.8418 11.6882 14.8978 11.5786 14.9102 11.4601C15.0511 10.2887 15.1213 9.10993 15.1203 7.93011C15.1207 6.73369 15.0505 5.53827 14.9102 4.3501C14.8881 4.22451 14.8189 4.11213 14.7166 4.03592C14.6144 3.9597 14.4869 3.92541 14.3602 3.94009V3.94009Z" fill="#20B6F2" /> <path class="volume-2" d="M17.1602 2.54991C17.1507 2.48806 17.1287 2.42881 17.0955 2.37577C17.0622 2.32274 17.0185 2.27704 16.967 2.24146C16.9156 2.20589 16.8574 2.1812 16.796 2.16889C16.7347 2.15659 16.6714 2.15693 16.6102 2.1699C16.549 2.18073 16.4906 2.20361 16.4382 2.23719C16.3859 2.27078 16.3408 2.31439 16.3054 2.36555C16.2701 2.4167 16.2452 2.47437 16.2323 2.5352C16.2194 2.59602 16.2187 2.65879 16.2302 2.71989C16.5436 4.439 16.7042 6.18248 16.7102 7.92991C16.7089 9.62788 16.5482 11.322 16.2302 12.9899C16.2172 13.0511 16.2169 13.1143 16.2292 13.1757C16.2415 13.2371 16.2662 13.2953 16.3018 13.3468C16.3373 13.3982 16.3831 13.4419 16.4361 13.4751C16.4891 13.5083 16.5484 13.5304 16.6102 13.5399H16.7102C16.8206 13.537 16.9271 13.4985 17.0136 13.4299C17.1002 13.3614 17.1621 13.2666 17.1902 13.1599C17.5176 11.436 17.6783 9.6846 17.6702 7.92991C17.6432 6.12589 17.4727 4.32687 17.1602 2.54991V2.54991Z" fill="#20B6F2" /> </svg></div>
      </div>
    </div>
    <button id="nextButton" class="bottom-6 w-5/6 absolute bg-primary text-white p-3 rounded-full focus:outline-none select-none focus:ring-2">下一个</button>
    <audio class="pronAudioWarp">{{发音}}</audio>
    <audio class="sentenAudioWarp">{{例句音频}}</audio>
  </div>
  <script>
    // v0.5.2 - https://github.com/SimonLammer/anki-persistence/blob/62463a7f63e79ce12f7a622a8ca0beb4c1c5d556/script.js
    if(void 0===window.Persistence){var _persistenceKey="github.com/SimonLammer/anki-persistence/",_defaultKey="_default";if(window.Persistence_sessionStorage=function(){var e=!1;try{"object"==typeof window.sessionStorage&&(e=!0,this.clear=function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);0==t.indexOf(_persistenceKey)&&(sessionStorage.removeItem(t),e--)}},this.setItem=function(e,t){void 0==t&&(t=e,e=_defaultKey),sessionStorage.setItem(_persistenceKey+e,JSON.stringify(t))},this.getItem=function(e){return void 0==e&&(e=_defaultKey),JSON.parse(sessionStorage.getItem(_persistenceKey+e))},this.removeItem=function(e){void 0==e&&(e=_defaultKey),sessionStorage.removeItem(_persistenceKey+e)})}catch(e){}this.isAvailable=function(){return e}},window.Persistence_windowKey=function(e){var t=window[e],i=!1;"object"==typeof t&&(i=!0,this.clear=function(){t[_persistenceKey]={}},this.setItem=function(e,i){void 0==i&&(i=e,e=_defaultKey),t[_persistenceKey][e]=i},this.getItem=function(e){return void 0==e&&(e=_defaultKey),t[_persistenceKey][e]||null},this.removeItem=function(e){void 0==e&&(e=_defaultKey),delete t[_persistenceKey][e]},void 0==t[_persistenceKey]&&this.clear()),this.isAvailable=function(){return i}},window.Persistence=new Persistence_sessionStorage,Persistence.isAvailable()||(window.Persistence=new Persistence_windowKey("py")),!Persistence.isAvailable()){var titleStartIndex=window.location.toString().indexOf("title"),titleContentIndex=window.location.toString().indexOf("main",titleStartIndex);titleStartIndex>0&&titleContentIndex>0&&titleContentIndex-titleStartIndex<10&&(window.Persistence=new Persistence_windowKey("qt"))}}
  </script>
  <script>
    const UA = navigator.userAgent;
    const isMobile = /Android/i.test(UA);
    const isAndroidWebview = /wv/i.test(UA);

    // Mock Anki API
    if (!isMobile) {
      AnkiDroidJS = {
        init: function() {},
        ankiGetNewCardCount: () => 20,
        ankiGetLrnCardCount: () => 100,
        ankiGetETA: () => '29'
      };
      function buttonAnswerEase1() { console.log(Persistence.getItem()); window.location = '/front.html'; };
      function buttonAnswerEase2() { console.log(Persistence.getItem()); window.location = '/front.html'; };
      function buttonAnswerEase3() { console.log(Persistence.getItem()); window.location = '/front.html'; };
      function buttonAnswerEase4() { console.log(Persistence.getItem()); window.location = '/front.html'; };
      function showAnswer() { window.location = '/back.html' };
    }

    const status = parseInt(Persistence.getItem(), 10);
    const nextButton = document.querySelector('#nextButton');
    nextButton.onclick = () => {
      switch (status) {
        case 4:
          buttonAnswerEase4();
          break;

        case 3:
          buttonAnswerEase3();
          break;

        case 2:
          buttonAnswerEase2();
          break;

        case 1:
          buttonAnswerEase1();
          break;

        default:
          break;
      }
    };
    
    // Init Pronounce Audio
    const pronReplaybutton = document.querySelectorAll('.pronAudioWarp > .replaybutton')[0];
    const pronounceAudio = document.createElement('audio');
    
    if (isMobile) pronounceAudio.src = pronReplaybutton.href.replace('playsound:', '');

    const PRONOUNCE_ANIMATION_TIME = 1.2;
    let audioTimeout = -1;

    playPronounce();

    function playPronounce() {
      document.querySelector('.pronAudioWarp').children[0].dispatchEvent(new MouseEvent('click'));
      // Animation
      const volume1 = document.querySelectorAll('.pronounceIcon > .volume-1')[0];
      const volume2 = document.querySelectorAll('.pronounceIcon > .volume-2')[0];

      setAudioAnimation(volume1, volume2, PRONOUNCE_ANIMATION_TIME);
    };

    // Init Sentence Audio
    const sentenReplaybutton = document.querySelectorAll('.sentenAudioWarp > .replaybutton')[0];
    const sentenceAudio = document.createElement('audio');
    if (isMobile) sentenceAudio.src = sentenReplaybutton.href.replace('playsound:', '');
    const sentenceAudioDuration = sentenceAudio.duration;

    const SENTENCE_ANIMATION_TIME = sentenceAudioDuration / 1000;

    function playSentence() {
      document.querySelector('.sentenAudioWarp').children[0].dispatchEvent(new MouseEvent('click'));
      // sentenceAudio.play();
      // Animation
      const volume1 = document.querySelectorAll('.sentenceIcon > .volume-1')[0];
      const volume2 = document.querySelectorAll('.sentenceIcon > .volume-2')[0];

      setAudioAnimation(volume1, volume2, SENTENCE_ANIMATION_TIME);
    }

    function setAudioAnimation(volume1, volume2, duration) {

      volume1.style.animation = `play 0.4s steps(4, end) ${parseInt(duration / 0.4, 10)}`;
      volume2.style.animation = `play 0.4s steps(2, end) ${parseInt(duration / 0.4, 10)}`;

      setTimeout(() => {
        clearAudioAnimation(volume1, volume2);
      }, duration * 1000);
    }

    function clearAudioAnimation(volume1, volume2) {
      volume1.style.animation = '';
      volume2.style.animation = '';
    };

    const playPronounceButton = document.querySelector('#playPronounceButton');
    playPronounceButton.onclick = () => {
      playPronounce();
    };

    const sentenceIcon = document.querySelector('.sentenceIcon');
    sentenceIcon.onclick = () => {
      playSentence();
    };

  </script>
  <script type="module" src="/main.js"></script>
</body>
</html>